<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RuBlocks - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="admin-container">
        <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ -->
        <div id="access-check" class="loading-screen">
            <div class="loading-spinner"></div>
            <div class="loading-text">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞...</div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å (—Å–∫—Ä—ã—Ç–∞ –¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏) -->
        <div id="admin-panel" style="display: none;">
            <!-- –®–∞–ø–∫–∞ -->
            <div class="admin-header">
                <div class="admin-header-left">
                    <h1>‚öôÔ∏è RuBlocks Admin Panel</h1>
                    <p class="admin-user">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: <strong id="admin-name">tolikpro128</strong></p>
                </div>
                <div class="admin-header-right">
                    <button class="btn-game" onclick="window.location.href='../pages/game.html'">
                        üéÆ –í –∏–≥—Ä—É
                    </button>
                    <button class="btn-logout" onclick="authSystem.logout()">–í—ã—Ö–æ–¥</button>
                </div>
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <div class="admin-nav">
                <button class="nav-btn active" onclick="showAdminTab('dashboard')">
                    üìä –î–∞—à–±–æ—Ä–¥
                </button>
                <button class="nav-btn" onclick="showAdminTab('users')">
                    üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                </button>
                <button class="nav-btn" onclick="showAdminTab('stats')">
                    üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </button>
                <button class="nav-btn" onclick="showAdminTab('settings')">
                    ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
                <button class="nav-btn" onclick="showAdminTab('logs')">
                    üìú –õ–æ–≥–∏
                </button>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="admin-content">
                
                <!-- –î–∞—à–±–æ—Ä–¥ -->
                <div id="tab-dashboard" class="admin-tab active">
                    <h2>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-info">
                                <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                                <div class="stat-value" id="total-users">0</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">üü¢</div>
                            <div class="stat-info">
                                <div class="stat-label">–û–Ω–ª–∞–π–Ω —Å–µ–π—á–∞—Å</div>
                                <div class="stat-value" id="online-users">0</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">üéÆ</div>
                            <div class="stat-info">
                                <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä</div>
                                <div class="stat-value" id="total-games">0</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">üèÜ</div>
                            <div class="stat-info">
                                <div class="stat-label">–ú–∞–∫—Å. —Ä–µ–∫–æ—Ä–¥</div>
                                <div class="stat-value" id="max-score">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</h3>
                        <canvas id="activity-chart" width="800" height="300"></canvas>
                    </div>

                    <div class="dashboard-section">
                        <h3>üèÜ –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤</h3>
                        <table class="admin-table" id="top-players-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>–ò–≥—Ä–æ–∫</th>
                                    <th>–†–µ–∫–æ—Ä–¥</th>
                                    <th>–£—Ä–æ–≤–µ–Ω—å</th>
                                    <th>–ú–æ–Ω–µ—Ç—ã</th>
                                </tr>
                            </thead>
                            <tbody id="top-players-body">
                                <tr>
                                    <td colspan="5">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
                <div id="tab-users" class="admin-tab" style="display: none;">
                    <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                    
                    <div class="search-bar">
                        <input type="text" id="user-search" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email...">
                        <button class="btn-primary" onclick="searchUsers()">–ù–∞–π—Ç–∏</button>
                    </div>

                    <table class="admin-table" id="users-table">
                        <thead>
                            <tr>
                                <th>–ê–≤–∞—Ç–∞—Ä</th>
                                <th>–ò–º—è</th>
                                <th>Email</th>
                                <th>–£—Ä–æ–≤–µ–Ω—å</th>
                                <th>–†–µ–∫–æ—Ä–¥</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="users-body">
                            <tr>
                                <td colspan="7">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div id="tab-stats" class="admin-tab" style="display: none;">
                    <h2>üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card-large">
                            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä</h3>
                            <div class="stat-details">
                                <p>–í—Å–µ–≥–æ –∏–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ: <strong id="games-total">0</strong></p>
                                <p>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∏–≥—Ä—ã: <strong id="avg-playtime">0 –º–∏–Ω</strong></p>
                                <p>–°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç: <strong id="avg-score">0</strong></p>
                            </div>
                        </div>

                        <div class="stat-card-large">
                            <h3>üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞</h3>
                            <div class="stat-details">
                                <p>–í—Å–µ–≥–æ –º–æ–Ω–µ—Ç –≤ –∏–≥—Ä–µ: <strong id="total-coins">0</strong></p>
                                <p>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–∞–Ω—Å: <strong id="avg-coins">0</strong></p>
                            </div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <h3>üìä –ì—Ä–∞—Ñ–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π</h3>
                        <canvas id="registrations-chart" width="800" height="300"></canvas>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="tab-settings" class="admin-tab" style="display: none;">
                    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>
                    
                    <div class="settings-section">
                        <h3>üéÆ –ò–≥—Ä–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
                        
                        <div class="setting-item">
                            <label>–ë–∞–∑–æ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ –∏–≥—Ä—É (–º–æ–Ω–µ—Ç—ã):</label>
                            <input type="number" id="setting-base-reward" value="10">
                        </div>

                        <div class="setting-item">
                            <label>–û–ø—ã—Ç –∑–∞ –ø–æ–±–µ–¥—É:</label>
                            <input type="number" id="setting-win-exp" value="50">
                        </div>

                        <div class="setting-item">
                            <label>–ú–Ω–æ–∂–∏—Ç–µ–ª—å –º–æ–Ω–µ—Ç (x):</label>
                            <input type="number" id="setting-coin-multiplier" value="1" step="0.1">
                        </div>

                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="setting-maintenance">
                                –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤)
                            </label>
                        </div>

                        <button class="btn-primary btn-large" onclick="saveSettings()">
                            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                    </div>

                    <div class="settings-section">
                        <h3>üóëÔ∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                        
                        <button class="btn-danger" onclick="clearAllGames()">
                            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –∏–≥—Ä
                        </button>
                        
                        <button class="btn-danger" onclick="resetAllStats()">
                            ‚ö†Ô∏è –°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
                        </button>
                    </div>
                </div>

                <!-- –õ–æ–≥–∏ -->
                <div id="tab-logs" class="admin-tab" style="display: none;">
                    <h2>üìú –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏</h2>
                    
                    <div class="logs-controls">
                        <button class="btn-secondary" onclick="refreshLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        <button class="btn-secondary" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button class="btn-secondary" onclick="exportLogs()">üì• –≠–∫—Å–ø–æ—Ä—Ç</button>
                    </div>

                    <div class="logs-container" id="logs-container">
                        <div class="log-entry log-info">
                            <span class="log-time">12:00:00</span>
                            <span class="log-message">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫–∞–∑–∞ –≤ –¥–æ—Å—Ç—É–ø–µ -->
        <div id="access-denied" style="display: none;">
            <div class="access-denied-container">
                <div class="access-denied-icon">üö´</div>
                <h1>–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω</h1>
                <p>–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.</p>
                <p>–¢–æ–ª—å–∫–æ <strong>tolikpro128</strong> –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</p>
                <button class="btn-primary" onclick="window.location.href='../pages/game.html'">
                    –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∏–≥—Ä—É
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- –ù–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="../js/firebase-config.js"></script>
    <script src="../js/database.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/admin-check.js"></script>
    <script src="admin.js"></script>
</body>
</html>